WindowManager: # define screens
    LoginWindow:
    MenuWindow:
    RegWindow:
    SearchWindow:
    StartScreen:
    PracScreen:
    #PracUndoScreen:
    DSpiralScreen:
    NdSpiralScreen:

<LoginWindow>:
    name: "login"

    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "orangeflowers.jpg"

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height

        padding: 50
        spacing: 50

        Label: 
            text: "Login with Password"
            bold: True
            pos_hint: {'center_x': 0.5, 'y':0.8}
            size_hint: (None, None)
            width: 400
            color: (1,1,1,1) #(0,0,0,1)
            font_size: 32

        TextInput:
            id: pw
            multiline: False
            hint_text: 'Please Enter Password:'
            pos_hint: {'center_x': 0.5, 'center_y':0.3}
            size_hint: (None, None)
            width: 400
            height: 80
            password: True
            padding: [30,30,20,20]

        Button:
            text: "Submit"
            pos_hint: {'center_x': 0.5}
            size_hint: (None, None)
            width: 200
            height: 50
            background_color: (0,1,1,1) #(0,150,141,1)
            color: (1,1,1,1) #(0,0,0,1)
            on_release: 
                app.root.current = "menu" if pw.text == "tremordr" else "login"
                root.manager.transition.direction = "left"

<MenuWindow>:
    name: "menu"
    FloatLayout:
        canvas.before:
            Rectangle:
                size: self.size
                source: "orangeflowers.jpg"
        FloatLayout: 

            Button:
                background_color: 0,1,1,1
                text: "New Patient"
                font_size: "30dp"
                size_hint: 0.3, 0.2
                pos_hint: {'x': .1, 'y': 0.3}
                on_release:
                    app.root.current="form"
                    root.manager.transition.direction = "left"

            Button:
                background_color: 0,1,1,1
                text: "Existing Patient"
                font_size: "30dp"
                size_hint: 0.3, 0.2
                pos_hint: {'x': .6, 'y': .3} 
                on_release:
                    app.root.current="search"
                    root.manager.transition.direction = "left"

<RegWindow>:
    name: "form"

    ptname: ptname
    ptsname: ptsname
    ptage: ptage
    ptnum: ptnum
    
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "orangeflowers.jpg"

    FloatLayout:

        Label:
            text: "Please Enter Patient Details"
            font_size: 20
            bold: True
            color: (1,1,1,1)
            pos_hint: {'center_x': 0.5, 'y':0.45} 

        BoxLayout:
            orientation: 'vertical'
            size: root.width, root.height

            padding: [40,40,40,40]
            spacing: 40

            GridLayout:
                cols: 2
                padding: [20,20,20,20]
                spacing: 20

                Label:
                    text: "Name: "
                    color: (1,1,1,1)
                    font_size: 20
                    halign: 'left'
                    background_color: (0,0,0,0.5)
                    canvas.before:
                        Color:
                            rgba: self.background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos

                TextInput:
                    id: ptname
                    multiline: False
                    hint_text: 'Enter patient name'
                    padding: [30,30,30,30]

                Label:
                    text: "Surname: "
                    color: (1,1,1,1)
                    font_size: 20
                    halign: 'left'
                    background_color: (0,0,0,0.5)
                    canvas.before:
                        Color:
                            rgba: self.background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos

                TextInput:
                    id: ptsname
                    multiline: False
                    hint_text: 'Enter patient surname'
                    padding: [30,30,30,30]

                Label:
                    text: "Age: "
                    color: (1,1,1,1)
                    font_size: 20
                    halign: 'left'
                    background_color: (0,0,0,0.5)
                    canvas.before:
                        Color:
                            rgba: self.background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos

                TextInput:
                    id: ptage
                    multiline: False
                    min_value: 1
                    max_value: 100
                    hint_text: 'Enter an age between {} and {}'.format(self.min_value, self.max_value)
                    padding: [30,30,30,30]

                Label:
                    text: "Contact Number: "
                    color: (1,1,1,1)
                    font_size: 20
                    halign: 'left'
                    background_color: (0,0,0,0.5)
                    canvas.before:
                        Color:
                            rgba: self.background_color
                        Rectangle:
                            size: self.size
                            pos: self.pos

                TextInput:
                    id: ptnum
                    multiline: False
                    hint_text: 'Enter a 10 digit phone number'
                    padding: [30,30,30,30]

            Button:
                text: "Submit"
                background_color: (0,1,1,1)
                color: (1,1,1,1)
                pos_hint: {'x': 0.6}
                size_hint: (None, None)
                width: 200
                height: 50
                halign: 'right'
                on_press: root.submit()
                on_release:
                    app.root.current = "start"
                    root.manager.transition.direction = "left"
                    
<SearchWindow>:
    name: "search"
    word_input:word_input
    surname_input:surname_input
    
    FloatLayout:

        Label:
            text: "Please Enter Patient Name and Surname"
            font_size: 20
            bold: True
            color: (1,1,1,1)
            pos_hint: {'center_x': 0.5, 'y':0.45} 
        
        FloatLayout:
            Label:
                id : word_label
                text: "Enter patient name :"
                pos_hint: {'x': 0.2, 'y' : 0.7}
                size_hint: (0.2, 0.1)
                
            TextInput:
                id: word_input
                multiline: False
                pos_hint: {'x': 0.5 , 'y' : 0.7}
                size_hint: (0.3, 0.1)

            Label:
                id : surname_label
                text: "Enter patient surname :"
                pos_hint: {'x': 0.2, 'y' : 0.5}
                size_hint: (0.2, 0.1)

            TextInput:
                id: surname_input
                multiline: False
                pos_hint: {'x': 0.5 , 'y' : 0.5}
                size_hint: (0.3, 0.1)

            Button:
                text: "Show patient details"
                pos_hint: {'x': 0.2 , 'y' : 0.3}
                size_hint: (0.2, 0.1)
                on_press: root.show_id()
            
            Label:
                id : id_label
                text: "Patient ID"
                hint_text: 'Patient ID'
                pos_hint: {'x': 0.5, 'y' : 0.3}
                size_hint: (0.3, 0.1)
                font_size: 20

            Button:
                text: "Start Assessment"
                pos_hint: {'x': 0.6, 'y' : 0.1}
                size_hint: (0.3, 0.1)
                font_size: 20
                on_release:
                    app.root.current="start"


<StartScreen>:
    name: "start"
    Button: 
        text: "Start Assessment"
        color: (1,1,1,1)
        background_color: (0,1,1,1)
        font_size: 40
        on_release:
            app.root.current = "prac"
            root.manager.transition.direction = "left"

<LineWidget>:
    canvas.before:
        Rectangle:
            size: root.width, root.height 
            pos: self.pos
            source: "linetemp.png"

<DrawLine>:

<PracScreen>:
    name: "prac"

    FloatLayout:
        id: export1
        LineWidget

        Label:
            text: "Draw a line within the box without lifting your finger"
            pos_hint: {"center_x": 0.5, "top": 1.3}
            font_size: 30
            color: (1,1,1,1)

        DrawLine

        Button:
            text: "Return to start"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"left": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            on_release:
                app.root.current = "start"
                root.manager.transition.direction = "right"

        # Button: 
        #     text: "Undo"
        #     pos_hint: {"x": 0.2, "bottom": 1}
        #     font_size: 20
        #     size_hint: 0.2, 0.1
        #     color: (1,1,1,1)
        #     background_color: (0,1,1,0.5)
        #     on_release:
        #         app.root.current = "undo_prac"
        #         root.manager.transition.direction = "right"
        
        Button: 
            id: 'screenshot'
            text: "Save Drawing"
            pos_hint: {"right": 0.8, "bottom": 1}
            font_size: 20
            size_hint: 0.2, 0.1
            color: (1,1,1,1)
            background_color: (0,1,1,0.5)
            on_release: root.capture()

        Button:
            text: "Next"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"right": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            on_release:
                app.root.current = "dom_spiral"
                root.manager.transition.direction = "left"

# <PracUndoScreen>:
#     name: "undo_prac"
    
#     FloatLayout:
#         LineWidget

#         Label:
#             text: "Draw a line within the box without lifting your finger"
#             pos_hint: {"center_x": 0.5, "top": 1.3}
#             font_size: 30
#             color: (1,1,1,1)

#         DrawLine

#         Button:
#             text: "Return to start"
#             font_size: 20
#             size_hint: 0.2, 0.1
#             pos_hint: {"left": 1, "bottom": 1}
#             background_color: (0,1,1,0.5)
#             on_release:
#                 app.root.current = "start"
#                 root.manager.transition.direction = "right"

#         Button:
#             text: "Next"
#             font_size: 20
#             size_hint: 0.2, 0.1
#             pos_hint: {"right": 1, "bottom": 1}
#             background_color: (0,1,1,0.5)
#             on_release:
#                 app.root.current = "dom_spiral"
#                 root.manager.transition.direction = "left"

<SpiralWidget>:
    canvas.before:
        Rectangle:
            size: root.width, root.height 
            pos: self.pos
            source: "spiraltemp.png"

<DSpiralScreen>:
    name: "dom_spiral" #dominant hand spiral

    FloatLayout:
        id: export2
        SpiralWidget

        Label:
            text: "Trace the spiral using your dominant hand."
            pos_hint: {"center_x": 0.5, "top": 1.45}
            font_size: 30
            color: (0,0,0,1)

        Label:
            text: "Start from the inside of the spiral."
            pos_hint: {"center_x": 0.5, "top": 1.36}
            font_size: 30
            color: (0,0,0,1)

        DrawLine

        Button:
            text: "Go Back"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"left": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            on_release:
                app.root.current = "prac"
                root.manager.transition.direction = "right"

        Button: 
            id: 'screenshot'
            text: "Save Drawing"
            pos_hint: {"right": 0.8, "bottom": 1}
            font_size: 20
            size_hint: 0.2, 0.1
            color: (1,1,1,1)
            background_color: (0,1,1,0.5)
            on_release: root.capture()

        Button:
            text: "Next"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"right": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            on_release:
                app.root.current = "nondom_spiral"
                root.manager.transition.direction = "left"

<NdSpiralScreen>:
    name: "nondom_spiral" # non-dominant hand spiral 

    FloatLayout:
        id: export3
        SpiralWidget

        Label:
            text: "Trace the spiral using your non-dominant hand."
            pos_hint: {"center_x": 0.5, "top": 1.45}
            font_size: 30
            color: (0,0,0,1)

        Label:
            text: "Start from the inside of the spiral."
            pos_hint: {"center_x": 0.5, "top": 1.36}
            font_size: 30
            color: (0,0,0,1)

        DrawLine

        Button:
            text: "Go Back"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"left": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            on_release:
                app.root.current = "prac"
                root.manager.transition.direction = "right"
        
        Button: 
            id: 'screenshot'
            text: "Save Drawing"
            pos_hint: {"right": 0.8, "bottom": 1}
            font_size: 20
            size_hint: 0.2, 0.1
            color: (1,1,1,1)
            background_color: (0,1,1,0.5)
            on_release: root.capture()

        Button:
            text: "Next"
            font_size: 20
            size_hint: 0.2, 0.1
            pos_hint: {"right": 1, "bottom": 1}
            background_color: (0,1,1,0.5)
            # on_release:
            #     app.root.current = "results"
            #     root.manager.transition.direction = "left"
